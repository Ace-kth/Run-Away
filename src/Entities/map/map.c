#include "map.h"

static int mapGrid[MAP_COLUMNS][MAP_ROWS] = {
    {68,68,68,68,68,92,68,68,68,77,91,68,92,68,68,68,69,79,71,86,93,91,68,68,92,68,68,77,91,92,69,79,71,86,87,86,91,68,68,68,77,87,86,91,68,68,68,68,68,68},
    {77,91,92,68,68,68,68,68,77,87,86,91,68,68,92,68,77,87,71,71,71,86,91,68,68,68,77,87,86,91,77,87,71,71,71,71,86,68,68,68,87,71,71,86,68,92,68,68,92,68},
    {87,89,68,68,93,93,91,68,69,70,79,71,0,1,3,59,1,1,1,1,1,1,2,77,91,77,87,0,1,1,1,1,7,7,7,7,7,7,8,87,71,71,71,88,68,68,68,68,68,68},
    {71,89,68,87,71,71,71,86,0,1,1,1,10,10,50,10,10,10,10,3,4,5,10,2,86,87,71,9,10,10,10,10,16,16,16,57,5,16,16,7,8,71,88,90,92,68,68,68,68,68},
    {71,86,87,71,71,71,0,1,10,10,10,10,10,10,10,10,10,10,10,21,22,23,10,10,1,1,1,10,10,10,19,19,25,25,16,16,49,16,16,16,16,97,7,7,8,68,68,68,92,68},
    {71,71,71,71,88,70,9,10,10,10,3,58,58,59,10,10,10,10,10,10,10,10,10,10,10,10,48,10,10,11,71,71,88,68,15,16,50,16,48,16,16,16,17,34,15,7,8,68,68,68},
    {71,71,71,71,89,68,9,10,10,10,49,10,10,10,10,10,10,10,10,10,10,10,10,10,10,3,23,10,10,11,70,90,68,92,15,16,16,16,49,16,17,34,35,92,33,15,97,87,86,91},
    {70,70,79,71,89,68,9,10,57,58,23,10,10,10,10,10,10,10,10,3,5,37,37,9,10,49,10,10,10,11,92,77,91,68,57,58,58,58,23,16,16,7,8,77,93,15,17,71,71,86},
    {68,80,87,71,86,93,9,10,10,10,10,10,3,5,10,10,10,10,10,12,14,84,81,9,10,50,10,11,28,29,77,87,86,91,15,16,16,16,16,16,16,16,17,87,71,15,17,71,71,88},
    {68,87,71,71,71,71,9,10,10,10,10,10,12,14,10,10,10,10,10,12,13,14,10,10,10,10,10,11,77,93,87,71,71,86,15,16,16,16,16,16,16,17,34,71,71,97,17,71,88,90},
    {78,71,71,71,71,88,27,9,10,10,10,10,12,14,37,9,10,10,10,21,22,23,10,10,10,10,10,11,87,71,71,71,71,88,15,16,16,3,4,5,16,17,71,71,71,15,17,71,89,68},
    {68,79,71,71,88,68,68,27,9,10,10,10,12,23,72,36,37,37,9,10,10,10,10,10,10,10,10,11,71,71,71,71,88,90,15,16,16,12,22,14,16,17,71,6,7,16,57,59,90,92},
    {68,69,70,70,90,92,68,68,9,10,10,10,12,11,81,82,82,67,36,37,38,3,5,10,10,10,10,10,1,2,71,88,68,68,15,3,58,23,70,12,5,17,71,15,16,16,16,16,8,68},
    {68,68,68,68,68,68,0,1,10,10,10,10,12,38,65,84,84,84,81,67,73,12,23,10,10,10,10,10,10,11,69,90,92,68,15,49,86,91,68,21,23,16,97,16,17,34,34,15,17,68},
    {68,68,92,68,68,0,10,10,10,10,57,58,22,58,58,58,58,58,58,58,58,23,10,10,10,10,10,48,10,11,68,68,68,68,15,21,58,5,7,16,16,16,16,16,34,68,6,16,17,68},
    {92,68,68,92,68,9,10,10,10,10,10,10,11,66,82,83,84,81,82,82,67,9,10,10,10,57,58,22,59,11,92,68,68,6,16,16,16,49,16,16,16,17,34,34,77,87,15,48,35,68},
    {4,4,4,4,4,4,4,4,5,10,10,10,11,83,84,84,84,84,84,84,72,9,10,10,10,10,10,10,10,10,1,1,7,16,16,16,16,50,16,16,16,17,68,77,87,71,15,50,88,68},
    {21,22,22,22,22,22,22,22,14,10,10,10,10,2,65,84,84,84,84,84,0,10,10,10,10,10,10,10,10,10,10,10,16,16,16,16,16,16,16,16,16,17,77,87,71,71,15,16,8,68},
    {75,64,65,84,84,63,66,67,12,4,5,10,10,11,75,65,0,10,10,10,10,10,10,10,57,58,5,10,10,11,28,28,34,34,15,16,16,16,16,16,16,17,69,79,71,71,71,15,17,92},
    {66,67,75,64,64,85,84,81,21,13,14,10,10,11,73,75,9,11,37,37,37,9,10,10,10,10,49,10,10,11,68,87,71,71,15,16,16,16,48,16,16,16,97,7,7,7,7,16,17,68},
    {84,72,73,66,83,84,84,63,65,12,14,10,10,10,1,1,10,10,10,73,73,36,37,37,9,10,50,10,10,11,87,71,71,71,15,16,57,58,23,16,16,16,16,16,16,97,16,16,17,68},
    {65,81,67,74,84,84,84,81,67,39,41,37,37,37,9,10,57,58,58,58,5,10,11,73,36,9,10,10,10,11,71,71,88,90,15,16,16,16,16,16,16,17,34,34,34,34,15,17,34,77},
    {74,63,76,74,84,84,84,84,72,73,73,73,73,73,36,9,10,10,10,10,49,10,11,82,67,36,37,9,10,11,71,71,89,68,52,34,34,15,17,34,15,17,91,77,93,91,15,17,77,87},
    {74,72,66,83,63,64,65,63,76,3,5,1,2,73,73,9,10,10,10,10,50,10,11,84,81,82,67,9,3,58,59,2,86,91,34,68,92,15,17,68,33,35,90,69,79,86,15,17,87,71},
    {83,72,74,63,73,66,83,72,66,12,14,10,10,1,1,10,48,10,10,10,10,10,48,2,84,84,81,9,49,10,10,11,71,86,68,92,68,15,17,68,92,68,68,77,87,71,15,17,71,88},
    {84,72,75,73,66,83,84,72,74,12,14,28,28,9,10,10,50,10,10,10,10,10,49,10,2,84,84,9,50,10,10,10,7,7,7,7,48,16,16,8,68,68,77,87,6,7,16,17,71,89},
    {84,81,67,73,75,65,84,81,74,12,14,92,68,27,9,10,10,10,10,10,10,10,50,10,10,1,1,10,10,10,10,10,16,16,16,16,21,59,16,16,7,7,7,7,16,16,97,17,79,86},
    {84,84,72,73,73,73,3,58,58,22,23,68,93,87,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,16,16,16,16,16,16,16,16,16,16,16,16,16,17,34,35,78,71},
    {65,84,81,67,73,73,49,10,10,11,77,87,71,88,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,34,34,34,34,34,34,34,34,34,34,34,34,34,35,93,93,87,71},
    {75,65,84,81,67,73,49,27,28,29,69,79,71,86,91,68,92,68,68,87,86,91,77,93,93,93,93,93,93,91,68,92,68,68,68,92,77,93,93,93,91,68,68,92,77,87,71,71,71,71},
};

static int dangerTiles[MAP_COLUMNS][MAP_ROWS] = {
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,0,1,95,95,1,1,1,1,1,1,2,95,95,95,95,0,1,1,1,1,7,7,7,7,7,7,8,95,95,95,95,95,95,95,95,95,95,95},
    {95,95,95,95,95,95,95,95,0,1,1,1,10,10,95,10,10,10,10,95,95,95,10,2,95,95,95,9,10,10,10,10,16,16,16,95,95,16,16,7,8,95,95,95,95,95,95,95,95,95},
    {95,95,95,95,95,95,0,1,10,10,10,10,10,10,10,10,10,10,10,95,95,95,10,10,1,1,1,10,10,10,95,95,95,95,16,16,95,16,16,16,16,95,7,7,8,95,95,95,95,95},
    {95,95,95,95,95,95,9,10,10,10,95,95,95,95,10,10,10,10,10,10,10,10,10,10,10,10,95,10,10,11,95,95,95,95,15,16,95,16,95,16,16,16,17,95,15,7,8,95,95,95},
    {95,95,95,95,95,95,9,10,10,10,95,10,10,10,10,10,10,10,10,10,10,10,10,10,10,95,95,10,10,11,95,95,95,95,15,16,16,16,95,16,17,95,95,95,95,15,95,95,95,95},
    {95,95,95,95,95,95,9,10,95,95,95,10,10,10,10,10,10,10,10,95,95,95,95,9,10,95,10,10,10,11,95,95,95,95,95,95,95,95,95,16,16,7,8,95,95,15,17,95,95,95},
    {95,95,95,95,95,95,9,10,10,10,10,10,95,95,10,10,10,10,10,95,95,95,95,9,10,95,10,11,95,95,95,95,95,95,15,16,16,16,16,16,16,16,17,95,95,15,17,95,95,95},
    {95,95,95,95,95,95,9,10,10,10,10,10,95,95,10,10,10,10,10,95,95,95,10,10,10,10,10,11,95,95,95,95,95,95,15,16,16,16,16,16,16,17,95,95,95,95,17,95,95,95},
    {95,95,95,95,95,95,95,9,10,10,10,10,95,95,95,9,10,10,10,95,95,95,10,10,10,10,10,11,95,95,95,95,95,95,15,16,16,95,95,95,16,17,95,95,95,15,17,95,95,95},
    {95,95,95,95,95,95,95,95,9,10,10,10,95,95,95,95,95,95,9,10,10,10,10,10,10,10,10,11,95,95,95,95,95,95,15,16,16,95,95,95,16,17,95,6,7,16,95,95,95,95},
    {95,95,95,95,95,95,95,95,9,10,10,10,95,95,95,95,95,95,95,95,95,95,95,10,10,10,10,10,1,2,95,95,95,95,15,95,95,95,95,95,95,17,95,15,16,16,16,16,8,95},
    {95,95,95,95,95,95,0,1,10,10,10,10,95,95,95,95,95,95,95,95,95,95,95,10,10,10,10,10,10,11,95,95,95,95,15,95,95,95,95,95,95,16,95,16,17,95,95,15,17,95},
    {95,95,95,95,95,0,10,10,10,10,95,95,95,95,95,95,95,95,95,95,95,95,10,10,10,10,10,95,10,11,95,95,95,95,15,95,95,95,7,16,16,16,16,16,95,95,6,16,17,95},
    {95,95,95,95,95,9,10,10,10,10,10,10,11,95,95,95,95,95,95,95,95,9,10,10,10,95,95,95,95,11,95,95,95,6,16,16,16,95,16,16,16,17,95,95,95,95,15,95,95,95},
    {95,95,95,95,95,95,95,95,95,10,10,10,11,95,95,95,95,95,95,95,95,9,10,10,10,10,10,10,10,10,1,1,7,16,16,16,16,95,16,16,16,17,95,95,95,95,15,95,95,95},
    {95,95,95,95,95,95,95,95,95,10,10,10,10,2,95,95,95,95,95,95,0,10,10,10,10,10,10,10,10,10,10,10,16,16,16,16,16,16,16,16,16,17,95,95,95,95,15,16,8,95},
    {95,95,95,95,95,95,95,95,95,95,95,10,10,11,95,95,0,10,10,10,10,10,10,10,95,95,95,10,10,11,95,95,95,95,15,16,16,16,16,16,16,17,95,95,95,95,95,15,17,95},
    {95,95,95,95,95,95,95,95,95,95,95,10,10,11,95,95,9,11,95,95,95,9,10,10,10,10,95,10,10,11,95,95,95,95,15,16,16,16,95,16,16,16,95,7,7,7,7,16,17,95},
    {95,95,95,95,95,95,95,95,95,95,95,10,10,10,1,1,10,10,10,95,95,95,95,95,9,10,95,10,10,11,95,95,95,95,15,16,95,95,95,16,16,16,16,16,16,95,16,16,17,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,9,10,95,95,95,95,95,10,11,95,95,9,10,10,10,11,95,95,95,95,15,16,16,16,16,16,16,17,95,95,95,95,15,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,9,10,10,10,10,95,10,11,95,95,95,95,9,10,11,95,95,95,95,52,95,95,15,17,95,15,17,95,95,95,95,15,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,1,2,95,95,9,10,10,10,10,95,10,11,95,95,95,95,9,95,95,95,2,95,95,95,95,95,15,17,95,95,95,95,95,95,95,15,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,10,10,1,1,10,95,10,10,10,10,10,95,2,95,95,95,9,95,10,10,11,95,95,95,95,95,15,17,95,95,95,95,95,95,95,15,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,9,10,10,95,10,10,10,10,10,95,10,2,95,95,9,95,10,10,10,7,7,7,7,95,16,16,8,95,95,95,95,6,7,16,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,9,10,10,10,10,10,10,10,95,10,10,1,1,10,10,10,10,10,16,16,16,16,95,95,16,16,7,7,7,7,16,16,95,17,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,16,16,16,16,16,16,16,16,16,16,16,16,16,17,95,95,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95},
    {95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95},
};

int getNumberOfRowsInMap() {
    return MAP_ROWS;
}

int getNumberOfColumnsInMap() {
    return MAP_COLUMNS;
}

int getTheWidthOfTheTile() {
    return TILE_WIDTH;
}

int getTheHeightOfTheTile() {
    return TILE_HEIGHT;
}

int getTileInformation(int x, int y) {

    return mapGrid[x][y];
}

int encountersForbiddenTile(int x, int y) {
    // The code is used to find the tile that a pixel is in. It takes the x and y position of the pixel and divides each by 3, and then adds 32 to each result. It then returns the result of each division. The result is the tile that the pixel is in.
    int tileX = y / 32;
    int tileY = x / 32;
    // printf("TileX: %d TileY: %d TileValue:%d\n", tileX, tileY,dangerTiles[tileX][tileY]);
    if (dangerTiles[tileX][tileY] == 95) {
        // printf("Collision!\n");
        return 1;
    }

    return 0;
}

void renderBackground(SDL_Renderer *renderer, Background resources) {
    SDL_Rect position;
    position.x = 0;
    position.y = 0;
    position.w = getTheWidthOfTheTile();
    position.h = getTheHeightOfTheTile();

    for (int i = 0; i < getNumberOfColumnsInMap(); i++) {
        for (int j = 0; j < getNumberOfRowsInMap(); j++) {
            position.x = j * getTheWidthOfTheTile();
            position.y = i * getTheHeightOfTheTile();
            SDL_RenderCopyEx(renderer, resources.tileAtlas, &resources.tilesGraphic[getTileInformation(i, j)], &position, 0, NULL, SDL_FLIP_NONE);
        }
    }
}
void initiateMapResources(SDL_Renderer *renderer, Background *resources) {
    resources->tileAtlas = IMG_LoadTexture(renderer, "resources/Tiles3.png");
    int tileIndex = 0;
    for (int y = 0; y < 11; y++) {
        for (int x = 0; x < 9; x++) {
            resources->tilesGraphic[tileIndex].x = x * 32;
            resources->tilesGraphic[tileIndex].y = y * 32;
            resources->tilesGraphic[tileIndex].w = 32;
            resources->tilesGraphic[tileIndex].h = 32;
            tileIndex++;
        }
    }
}